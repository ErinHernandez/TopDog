/**
 * County FIPS code lookup
 *
 * Maps state + county name to 5-digit FIPS code.
 * Data sourced from US Census Bureau.
 *
 * NOTE: This file contains a sample of counties. For production,
 * populate with the complete dataset of all 3,143 US counties.
 * See: https://api.fips.codes/ or US Census Bureau data sources.
 */

// Structure: { stateCode: { countyName: fipsCode } }
// County names should be normalized (no "County" suffix, proper casing)
const COUNTY_FIPS: Record<string, Record<string, string>> = {
  'AL': {
    'Autauga': '01001',
    'Baldwin': '01003',
    'Barbour': '01005',
    'Bibb': '01007',
    'Blount': '01009',
    'Bullock': '01011',
    'Butler': '01013',
    'Calhoun': '01015',
    'Chambers': '01017',
    'Cherokee': '01019',
    'Chilton': '01021',
    'Choctaw': '01023',
    'Clarke': '01025',
    'Clay': '01027',
    'Cleburne': '01029',
    'Coffee': '01031',
    'Colbert': '01033',
    'Conecuh': '01035',
    'Coosa': '01037',
    'Covington': '01039',
    'Crenshaw': '01041',
    'Cullman': '01043',
    'Dale': '01045',
    'Dallas': '01047',
    'DeKalb': '01049',
    'Elmore': '01051',
    'Escambia': '01053',
    'Etowah': '01055',
    'Fayette': '01057',
    'Franklin': '01059',
    'Geneva': '01061',
    'Greene': '01063',
    'Hale': '01065',
    'Henry': '01067',
    'Houston': '01069',
    'Jackson': '01071',
    'Jefferson': '01073',
    'Lamar': '01075',
    'Lauderdale': '01077',
    'Lawrence': '01079',
    'Lee': '01081',
    'Limestone': '01083',
    'Lowndes': '01085',
    'Macon': '01087',
    'Madison': '01089',
    'Marengo': '01091',
    'Marion': '01093',
    'Marshall': '01095',
    'Mobile': '01097',
    'Monroe': '01099',
    'Montgomery': '01101',
    'Morgan': '01103',
    'Perry': '01105',
    'Pickens': '01107',
    'Pike': '01109',
    'Randolph': '01111',
    'Russell': '01113',
    'St. Clair': '01115',
    'Shelby': '01117',
    'Sumter': '01119',
    'Talladega': '01121',
    'Tallapoosa': '01123',
    'Tuscaloosa': '01125',
    'Walker': '01127',
    'Washington': '01129',
    'Wilcox': '01131',
    'Winston': '01133',
  },
  'AK': {
    'Aleutians East': '02013',
    'Aleutians West': '02016',
    'Anchorage': '02020',
    'Bethel': '02050',
    'Bristol Bay': '02060',
    'Denali': '02068',
    'Dillingham': '02070',
    'Fairbanks North Star': '02090',
    'Haines': '02100',
    'Hoonah-Angoon': '02105',
    'Juneau': '02110',
    'Kenai Peninsula': '02122',
    'Ketchikan Gateway': '02130',
    'Kodiak Island': '02150',
    'Lake and Peninsula': '02164',
    'Matanuska-Susitna': '02170',
    'Nome': '02180',
    'North Slope': '02185',
    'Northwest Arctic': '02188',
    'Petersburg': '02195',
    'Prince of Wales-Hyder': '02198',
    'Sitka': '02220',
    'Skagway': '02230',
    'Southeast Fairbanks': '02240',
    'Valdez-Cordova': '02261',
    'Wrangell': '02275',
    'Yakutat': '02282',
    'Yukon-Koyukuk': '02290',
  },
  'CA': {
    'Alameda': '06001',
    'Alpine': '06003',
    'Amador': '06005',
    'Butte': '06007',
    'Calaveras': '06009',
    'Colusa': '06011',
    'Contra Costa': '06013',
    'Del Norte': '06015',
    'El Dorado': '06017',
    'Fresno': '06019',
    'Glenn': '06021',
    'Humboldt': '06023',
    'Imperial': '06025',
    'Inyo': '06027',
    'Kern': '06029',
    'Kings': '06031',
    'Lake': '06033',
    'Lassen': '06035',
    'Los Angeles': '06037',
    'Madera': '06039',
    'Marin': '06041',
    'Mariposa': '06043',
    'Mendocino': '06045',
    'Merced': '06047',
    'Modoc': '06049',
    'Mono': '06051',
    'Monterey': '06053',
    'Napa': '06055',
    'Nevada': '06057',
    'Orange': '06059',
    'Placer': '06061',
    'Plumas': '06063',
    'Riverside': '06065',
    'Sacramento': '06067',
    'San Benito': '06069',
    'San Bernardino': '06071',
    'San Diego': '06073',
    'San Francisco': '06075',
    'San Joaquin': '06077',
    'San Luis Obispo': '06079',
    'San Mateo': '06081',
    'Santa Barbara': '06083',
    'Santa Clara': '06085',
    'Santa Cruz': '06087',
    'Shasta': '06089',
    'Sierra': '06091',
    'Siskiyou': '06093',
    'Solano': '06095',
    'Sonoma': '06097',
    'Stanislaus': '06099',
    'Sutter': '06101',
    'Tehama': '06103',
    'Trinity': '06105',
    'Tulare': '06107',
    'Tuolumne': '06109',
    'Ventura': '06111',
    'Yolo': '06113',
    'Yuba': '06115',
  },
  'TX': {
    'Anderson': '48001',
    'Andrews': '48003',
    'Angelina': '48005',
    'Aransas': '48007',
    'Archer': '48009',
    'Armstrong': '48011',
    'Atascosa': '48013',
    'Austin': '48015',
    'Bailey': '48017',
    'Bandera': '48019',
    'Bastrop': '48021',
    'Baylor': '48023',
    'Bee': '48025',
    'Bell': '48027',
    'Bexar': '48029',
    'Blanco': '48031',
    'Borden': '48033',
    'Bosque': '48035',
    'Bowie': '48037',
    'Brazoria': '48039',
    'Brazos': '48041',
    'Brewster': '48043',
    'Briscoe': '48045',
    'Brooks': '48047',
    'Brown': '48049',
    'Burleson': '48051',
    'Burnet': '48053',
    'Caldwell': '48055',
    'Calhoun': '48057',
    'Callahan': '48059',
    'Cameron': '48061',
    'Camp': '48063',
    'Carson': '48065',
    'Cass': '48067',
    'Castro': '48069',
    'Chambers': '48071',
    'Cherokee': '48073',
    'Childress': '48075',
    'Clay': '48077',
    'Cochran': '48079',
    'Coke': '48081',
    'Coleman': '48083',
    'Collin': '48085',
    'Collingsworth': '48087',
    'Colorado': '48089',
    'Comal': '48091',
    'Comanche': '48093',
    'Concho': '48095',
    'Cooke': '48097',
    'Coryell': '48099',
    'Cottle': '48101',
    'Crane': '48103',
    'Crockett': '48105',
    'Crosby': '48107',
    'Culberson': '48109',
    'Dallam': '48111',
    'Dallas': '48113',
    'Dawson': '48115',
    'Deaf Smith': '48117',
    'Delta': '48119',
    'Denton': '48121',
    'DeWitt': '48123',
    'Dickens': '48125',
    'Dimmit': '48127',
    'Donley': '48129',
    'Duval': '48131',
    'Eastland': '48133',
    'Ector': '48135',
    'Edwards': '48137',
    'Ellis': '48139',
    'El Paso': '48141',
    'Erath': '48143',
    'Falls': '48145',
    'Fannin': '48147',
    'Fayette': '48149',
    'Fisher': '48151',
    'Floyd': '48153',
    'Foard': '48155',
    'Fort Bend': '48157',
    'Franklin': '48159',
    'Freestone': '48161',
    'Frio': '48163',
    'Gaines': '48165',
    'Galveston': '48167',
    'Garza': '48169',
    'Gillespie': '48171',
    'Glasscock': '48173',
    'Goliad': '48175',
    'Gonzales': '48177',
    'Gray': '48179',
    'Grayson': '48181',
    'Gregg': '48183',
    'Grimes': '48185',
    'Guadalupe': '48187',
    'Hale': '48189',
    'Hall': '48191',
    'Hamilton': '48193',
    'Hansford': '48195',
    'Hardeman': '48197',
    'Hardin': '48199',
    'Harris': '48201',
    'Harrison': '48203',
    'Hartley': '48205',
    'Haskell': '48207',
    'Hays': '48209',
    'Hemphill': '48211',
    'Henderson': '48213',
    'Hidalgo': '48215',
    'Hill': '48217',
    'Hockley': '48219',
    'Hood': '48221',
    'Hopkins': '48223',
    'Houston': '48225',
    'Howard': '48227',
    'Hudspeth': '48229',
    'Hunt': '48231',
    'Hutchinson': '48233',
    'Irion': '48235',
    'Jack': '48237',
    'Jackson': '48239',
    'Jasper': '48241',
    'Jeff Davis': '48243',
    'Jefferson': '48245',
    'Jim Hogg': '48247',
    'Jim Wells': '48249',
    'Johnson': '48251',
    'Jones': '48253',
    'Karnes': '48255',
    'Kaufman': '48257',
    'Kendall': '48259',
    'Kenedy': '48261',
    'Kent': '48263',
    'Kerr': '48265',
    'Kimble': '48267',
    'King': '48269',
    'Kinney': '48271',
    'Kleberg': '48273',
    'Knox': '48275',
    'Lamar': '48277',
    'Lamb': '48279',
    'Lampasas': '48281',
    'La Salle': '48283',
    'Lavaca': '48285',
    'Lee': '48287',
    'Leon': '48289',
    'Liberty': '48291',
    'Limestone': '48293',
    'Lipscomb': '48295',
    'Live Oak': '48297',
    'Llano': '48299',
    'Loving': '48301',
    'Lubbock': '48303',
    'Lynn': '48305',
    'McCulloch': '48307',
    'McLennan': '48309',
    'McMullen': '48311',
    'Madison': '48313',
    'Marion': '48315',
    'Martin': '48317',
    'Mason': '48319',
    'Matagorda': '48321',
    'Maverick': '48323',
    'Medina': '48325',
    'Menard': '48327',
    'Midland': '48329',
    'Milam': '48331',
    'Mills': '48333',
    'Mitchell': '48335',
    'Montague': '48337',
    'Montgomery': '48339',
    'Moore': '48341',
    'Morris': '48343',
    'Motley': '48345',
    'Nacogdoches': '48347',
    'Navarro': '48349',
    'Newton': '48351',
    'Nolan': '48353',
    'Nueces': '48355',
    'Ochiltree': '48357',
    'Oldham': '48359',
    'Orange': '48361',
    'Palo Pinto': '48363',
    'Panola': '48365',
    'Parker': '48367',
    'Parmer': '48369',
    'Pecos': '48371',
    'Polk': '48373',
    'Potter': '48375',
    'Presidio': '48377',
    'Rains': '48379',
    'Randall': '48381',
    'Reagan': '48383',
    'Real': '48385',
    'Red River': '48387',
    'Reeves': '48389',
    'Refugio': '48391',
    'Roberts': '48393',
    'Robertson': '48395',
    'Rockwall': '48397',
    'Runnels': '48399',
    'Rusk': '48401',
    'Sabine': '48403',
    'San Augustine': '48405',
    'San Jacinto': '48407',
    'San Patricio': '48409',
    'San Saba': '48411',
    'Schleicher': '48413',
    'Scurry': '48415',
    'Shackelford': '48417',
    'Shelby': '48419',
    'Sherman': '48421',
    'Smith': '48423',
    'Somervell': '48425',
    'Starr': '48427',
    'Stephens': '48429',
    'Sterling': '48431',
    'Stonewall': '48433',
    'Sutton': '48435',
    'Swisher': '48437',
    'Tarrant': '48439',
    'Taylor': '48441',
    'Terrell': '48443',
    'Terry': '48445',
    'Throckmorton': '48447',
    'Titus': '48449',
    'Tom Green': '48451',
    'Travis': '48453',
    'Trinity': '48455',
    'Tyler': '48457',
    'Upshur': '48459',
    'Upton': '48461',
    'Uvalde': '48463',
    'Val Verde': '48465',
    'Van Zandt': '48467',
    'Victoria': '48469',
    'Walker': '48471',
    'Waller': '48473',
    'Ward': '48475',
    'Washington': '48477',
    'Webb': '48479',
    'Wharton': '48481',
    'Wheeler': '48483',
    'Wichita': '48485',
    'Wilbarger': '48487',
    'Willacy': '48489',
    'Williamson': '48491',
    'Wilson': '48493',
    'Winkler': '48495',
    'Wise': '48497',
    'Wood': '48499',
    'Yoakum': '48501',
    'Young': '48503',
    'Zapata': '48505',
    'Zavala': '48507',
  },
  'NY': {
    'Albany': '36001',
    'Allegany': '36003',
    'Bronx': '36005',
    'Broome': '36007',
    'Cattaraugus': '36009',
    'Cayuga': '36011',
    'Chautauqua': '36013',
    'Chemung': '36015',
    'Chenango': '36017',
    'Clinton': '36019',
    'Columbia': '36021',
    'Cortland': '36023',
    'Delaware': '36025',
    'Dutchess': '36027',
    'Erie': '36029',
    'Essex': '36031',
    'Franklin': '36033',
    'Fulton': '36035',
    'Genesee': '36037',
    'Greene': '36039',
    'Hamilton': '36041',
    'Herkimer': '36043',
    'Jefferson': '36045',
    'Kings': '36047',
    'Lewis': '36049',
    'Livingston': '36051',
    'Madison': '36053',
    'Monroe': '36055',
    'Montgomery': '36057',
    'Nassau': '36059',
    'New York': '36061',
    'Niagara': '36063',
    'Oneida': '36065',
    'Onondaga': '36067',
    'Ontario': '36069',
    'Orange': '36071',
    'Orleans': '36073',
    'Oswego': '36075',
    'Otsego': '36077',
    'Putnam': '36079',
    'Queens': '36081',
    'Rensselaer': '36083',
    'Richmond': '36085',
    'Rockland': '36087',
    'St. Lawrence': '36089',
    'Saratoga': '36091',
    'Schenectady': '36093',
    'Schoharie': '36095',
    'Schuyler': '36097',
    'Seneca': '36099',
    'Steuben': '36101',
    'Suffolk': '36103',
    'Sullivan': '36105',
    'Tioga': '36107',
    'Tompkins': '36109',
    'Ulster': '36111',
    'Warren': '36113',
    'Washington': '36115',
    'Wayne': '36117',
    'Westchester': '36119',
    'Wyoming': '36121',
    'Yates': '36123',
  },
  // NOTE: This is a sample. For production, add all remaining states:
  // FL, IL, PA, OH, GA, NC, MI, NJ, VA, WA, AZ, MA, TN, IN, MO, MD, WI, CO, MN, SC, AL, LA, KY, OR, OK, CT, IA, MS, AR, KS, UT, NV, NM, WV, NE, ID, HI, NH, ME, MT, RI, DE, SD, ND, AK, VT, DC, WY
  // Each state should have all its counties mapped.
};

// Reverse lookup: { "US-CA-06037": "Los Angeles" }
const COUNTY_NAMES: Record<string, string> = {};

// Build reverse lookup on module load
for (const [stateCode, counties] of Object.entries(COUNTY_FIPS)) {
  for (const [countyName, fipsCode] of Object.entries(counties)) {
    COUNTY_NAMES[`US-${stateCode}-${fipsCode}`] = countyName;
  }
}

/**
 * Get county FIPS code from state code and county name
 * @param stateCode Two-letter state code (e.g., "CA")
 * @param countyName County name (with or without "County" suffix)
 * @returns 5-digit FIPS code or null if not found
 */
export function getCountyFipsCode(stateCode: string, countyName: string): string | null {
  const stateCounties = COUNTY_FIPS[stateCode];
  if (!stateCounties) return null;

  // Normalize county name (remove "County" suffix, trim)
  const normalized = countyName.replace(/ County$/i, '').trim();

  // Try exact match
  if (stateCounties[normalized]) {
    return stateCounties[normalized];
  }

  // Try case-insensitive
  const lowerNormalized = normalized.toLowerCase();
  for (const [name, fips] of Object.entries(stateCounties)) {
    if (name.toLowerCase() === lowerNormalized) {
      return fips;
    }
  }

  return null;
}

/**
 * Get county name from county code
 * @param code County code in format "US-{stateCode}-{fipsCode}"
 * @returns County name or null if not found
 */
export function getCountyNameFromCode(code: string): string | null {
  return COUNTY_NAMES[code] || null;
}

/**
 * Validate county code format
 * @param code County code to validate
 * @returns true if format is valid and code exists
 */
export function isValidCountyCode(code: string): boolean {
  return /^US-[A-Z]{2}-\d{5}$/.test(code) && COUNTY_NAMES[code] !== undefined;
}
